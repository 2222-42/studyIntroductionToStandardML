問3.4

> fun twice f x = f (f x)

`f x` が型エラーを起こさないなら、
- 仮引数`f`の型`t2`は関数型であり、
- 仮引数`x`の型を`X`とすると、`t2`の型は`X -> Y`となる。

そして`f (f x)`が型エラーを起こさないということは、
- 仮引数`f`の型`t2`は関数型であり、
- 引数`f x`の型`Y`を受取れるようにするべきであり、
- よって、型`X`と型`Y`は一致している必要がある。

よって、`twice`の型は、`X -> X`を受取、`X -> X`を返し、`X`を受取、`X`を返す。

`X`は任意の型であるから、多相型変数を使うと`('a -> 'a) -> 'a -> 'a`と表される。

筆者の回答方法：

twiceの各変数に対して仮定された型　τ1,…,τ5が満たすべき等式を 以下のように書き下すことができる。

- τ1 = τ2 ⟶ τ3 ⟶ τ5
- τ2 = τ3 ⟶ τ4 
- τ2 = τ4 ⟶ τ5 

2番目と3番目の等式から、以下のような等式集合が導ける。

- τ1 = τ2 ⟶ τ3 ⟶ τ5
- τ2 = τ3 ⟶ τ4
- τ3 = τ4
- τ4 = τ5

解けた形の等式 τ4=τ5を使い、変数τ4を消去すると

- τ1 = τ2⟶τ3⟶τ5
- τ2 = τ3⟶τ5
- τ3 = τ5

これを繰り返すと、
	
τ1=(τ5⟶τ5)⟶τ5⟶τ5

が得られる。

τ5は、何も等式が存在しない自由変数である。 この型を型変数’aとすると、

twice : (’a -> ’a) -> ’a -> ’a

を得る。

回答者のコメント：天才か？
